<div class="container">
  <div class="card">
    <h2>Register Your Restaurant</h2>
    
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <!-- Step Progress -->
      <div style="display:flex; justify-content:space-between; margin-bottom: 2rem; border-bottom: 1px solid #eee; padding-bottom: 1rem;">
        <div [style.color]="currentStep() >= 1 ? 'var(--primary-color)' : '#ccc'">1. Basic Details</div>
        <div [style.color]="currentStep() >= 2 ? 'var(--primary-color)' : '#ccc'">2. Operation Info</div>
        <div [style.color]="currentStep() >= 3 ? 'var(--primary-color)' : '#ccc'">3. Location</div>
      </div>

      <!-- Step 1: Basic Info -->
      @if (currentStep() === 1) {
        <div class="input-group">
            <label>Restaurant Name</label>
            <input type="text" formControlName="name" placeholder="e.g. Tandoor Flames">
        </div>

        <div class="input-group">
            <label>Description</label>
            <textarea formControlName="description" rows="3" placeholder="Brief description..."></textarea>
        </div>

        <div class="grid">
            <div class="input-group">
            <label>Phone Number</label>
            <input type="text" formControlName="phone" placeholder="10 digit mobile">
            </div>
            <div class="input-group">
            <label>Email</label>
            <input type="email" formControlName="email">
            </div>
        </div>
      }

      <!-- Step 2: Operation Info -->
      @if (currentStep() === 2) {
        <div class="input-group">
            <label>Cuisine Types (comma separated)</label>
            <input type="text" formControlName="cuisineTypes" placeholder="e.g. North Indian, Chinese, Italian">
        </div>

        <div class="grid">
            <div class="input-group">
            <label>Opening Time</label>
            <input type="time" formControlName="openingTime">
            </div>
            <div class="input-group">
            <label>Closing Time</label>
            <input type="time" formControlName="closingTime">
            </div>
        </div>
      }

      <!-- Step 3: Address -->
      @if (currentStep() === 3) {
        <h3>Location Details</h3>
        <p style="color:#666; margin-bottom:1rem;">Please select your restaurant's exact location on the map.</p>
        
        <button type="button" class="btn-secondary" (click)="openAddressDialog()" style="width:auto; margin-bottom:1.5rem;">
            üìç Select Location on Map
        </button>

        <div formGroupName="address">
            @if (form.get('address.addressLine1')?.value) {
                <div class="address-preview">
                    <strong>Selected Address:</strong>
                    <p>{{ form.get('address.addressLine1')?.value }}</p>
                    <p>{{ form.get('address.city')?.value }}, {{ form.get('address.state')?.value }} - {{ form.get('address.pincode')?.value }}</p>
                    <small style="color:#888">Lat: {{ form.get('address.latitude')?.value | number:'1.4-4' }}, Lng: {{ form.get('address.longitude')?.value | number:'1.4-4' }}</small>
                </div>
            } @else {
                <div class="address-preview" style="color:#999; font-style:italic;">
                    No location selected yet.
                </div>
            }
        </div>
      }
      
      @if (error()) {
        <div class="error">{{ error() }}</div>
      }

      <div class="grid" style="margin-top: 2rem;">
        @if (currentStep() > 1) {
            <button type="button" (click)="prevStep()" style="background:#666">Back</button>
        } @else {
            <div></div> <!-- Spacer -->
        }

        @if (currentStep() < 3) {
            <button type="button" (click)="nextStep()">Next</button>
        } @else {
            <button type="submit" [disabled]="form.invalid || loading()">
                {{ loading() ? 'Creating...' : 'Continue to Verification' }}
            </button>
        }
      </div>

    </form>
  </div>
</div>
